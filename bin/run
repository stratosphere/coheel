#!/usr/bin/env /bin/bash

# Exit on first failure
set -e

# Prepare the params with an '|' character in between, as Maven requires
PARAMS=
for i in "$@"; do
	# Concatenate with '|' in-between
	PARAMS="$PARAMS|$i"
done
# Remove the leading '|'
PARAMS="${PARAMS#"|"}"

# Remove old log files
rm run-output compile-output 2> /dev/null
# Display start time
date --rfc-3339=seconds | tee -a run-output
# Compile first ..
echo "Compiling .."
mvn compile > compile-output
# .. then run the app
echo "Running .."
echo "--------------------------------------------------------------------------" | tee -a run-output
mvn -q scala:run -DaddArgs="$PARAMS" | tee -a run-output
echo "--------------------------------------------------------------------------" | tee -a run-output
# Display end time
date --rfc-3339=seconds | tee -a run-output
