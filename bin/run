#!/usr/bin/env /bin/bash

# Remove old log files
rm run-output package-output 2> /dev/null

# Prepare the params with an '|' character in between, as Maven requires
PARAMS=
for i in "$@"; do
	# Concatenate with '|' in-between
	PARAMS="$PARAMS|$i"
done
# Remove the leading '|'
PARAMS="${PARAMS#"|"}"

# Compile first ..
echo -n "Packaging .."
mvn package > package-output
if [ $? -eq 0 ]; then
	# .. then run the app
	echo " Done."
	echo "Running .."
	echo "--------------------------------------------------------------------------" | tee -a run-output
	mvn -q scala:run -Dlauncher=ProgramRunner -DaddArgs="$PARAMS" | tee -a run-output
	echo "--------------------------------------------------------------------------" | tee -a run-output
else
	echo " Failed."
	cat package-output
fi
