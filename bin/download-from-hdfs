#!/usr/bin/env /bin/bash

if [ "$#" -ne 1 ]; then
	echo "Please pass exactly one file/directory to download."
	echo "$0 [wiki file]"
	exit 1
fi

rm ./cluster-output/$1.wiki 2> /dev/null

$HADOOP_HOME/bin/hdfs dfs -copyToLocal hdfs://tenemhead2/home/stefan.bunk/results/$1.wiki . 2>&1 | grep --invert-match "NativeCodeLoader"
echo "Downloaded."
find ./$1.wiki -type f -exec cat {} + | LC_ALL=C sort > ./$1.wiki.tmp
echo "Sorted."
rm -r ./$1.wiki
mv ./$1.wiki.tmp ./cluster-output/$1.wiki
echo "Done."
